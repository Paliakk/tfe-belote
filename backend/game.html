<!DOCTYPE html>
<html lang="fr">

<head>
  <base href="./">
  <meta charset="UTF-8" />
  <title>Belote ‚Äì Table</title>
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src http://localhost:3000 ws://localhost:3000;
    script-src 'self' https://cdn.socket.io;
    style-src 'self' 'unsafe-inline';
    img-src 'self' data:;
  ">
  <link rel="icon" href="data:,">
  <style>
    :root {
      --card-w: 70px;
      --card-h: 100px;
      --team1: #2563eb;
      --team2: #f59e0b;
      --team2-bg: #fef3c7;
      --team1-bg: #dbeafe;
      /* bleu tr√®s clair */
      --team2-bg: #fef3c7;
      /* ambre tr√®s clair */
    }

    /* Si√®ges color√©s par √©quipe */
    .seat.team1 {
      box-shadow: inset 0 0 0 2px var(--team1);
    }

    .seat.team2 {
      box-shadow: inset 0 0 0 2px var(--team2);
    }

    /* Anneau de couleur autour des cartes pos√©es (tapis & dernier pli) */
    .card.team1-ring {
      box-shadow: 0 0 0 4px var(--team1) inset, 0 2px 6px rgba(0, 0, 0, .35);
    }

    .card.team2-ring {
      box-shadow: 0 0 0 4px var(--team2) inset, 0 2px 6px rgba(0, 0, 0, .35);
    }

    /* Scoreboard courant */
    #scoreboard .team.t1 {
      background: var(--team1-bg);
      border: 1px solid var(--team1);
    }

    #scoreboard .team.t2 {
      background: var(--team2-bg);
      border: 1px solid var(--team2);
    }

    /* Scoreboard total (üí° manquait) */
    #scoreboard-total .team.t1 {
      background: var(--team1-bg);
      border: 1px solid var(--team1);
    }

    #scoreboard-total .team.t2 {
      background: var(--team2-bg);
      border: 1px solid var(--team2);
    }

    body {
      font-family: system-ui, sans-serif;
      padding: 14px;
      background: #0a7b45;
      color: #111;
    }

    h1 {
      color: #fff;
    }

    .row {
      margin: 8px 0;
    }

    button {
      margin: 4px 8px 4px 0;
    }

    #table {
      position: relative;
      margin: 12px auto 16px;
      width: 820px;
      height: 520px;
      background: radial-gradient(ellipse at center, #0aa255 0%, #08693b 65%, #065a33 100%);
      border-radius: 24px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, .35), inset 0 0 0 6px #0d5533cc;
    }

    .seat {
      position: absolute;
      width: 200px;
      height: 120px;
      color: #fff;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .seat.me {
      outline: 2px dashed #fff4;
      border-radius: 12px;
    }

    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #fff;
      color: #333;
      margin-left: 6px;
    }

    #center {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 300px;
      height: 200px;
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: center;
    }

    #returned {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #trick {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
    }

    #my-hand {
      margin: 10px auto;
      width: 820px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .card {
      width: var(--card-w);
      height: var(--card-h);
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, .35);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      cursor: default;
    }

    .card.hoverable:hover {
      transform: scale(1.08) translateY(-6px);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 35);
      cursor: pointer;
    }

    .card.disabled {
      opacity: .45;
      filter: grayscale(70%);
      cursor: not-allowed;
      pointer-events: none;
    }

    .card .rank {
      position: absolute;
      left: 6px;
      top: 4px;
      font: 600 14px system-ui;
    }

    .card .suit {
      font-size: 26px;
    }

    .card.red {
      color: #c02020;
    }

    .card.black {
      color: #222;
    }

    .card.sel {
      outline: 2px solid #3aa3ff;
    }

    .mini {
      transform: scale(.85);
      opacity: .95
    }

    #log {
      background: #111;
      color: #9f9;
      padding: 10px;
      min-height: 200px;
      white-space: pre-wrap;
      font-family: monospace;
    }

    .muted {
      opacity: .7
    }

    .btns {
      margin: 6px 0
    }

    .btns button[disabled] {
      opacity: .4;
      cursor: not-allowed
    }

    #trick-grid {
      position: absolute;
      inset: 0;
      pointer-events: none;
      /* pas de clics bloqu√©s */
      z-index: 2;
      /* au-dessus du centre */
    }

    .trick-slot {
      position: absolute;
      width: var(--card-w);
      height: var(--card-h);
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Positions : centre-top, centre-right, centre-bottom, centre-left */
    #trick-n {
      left: 410px;
      top: 140px;
    }

    #trick-e {
      left: 640px;
      top: 260px;
    }

    #trick-s {
      left: 410px;
      top: 390px;
    }

    #trick-w {
      left: 180px;
      top: 260px;
    }
  </style>
</head>

<body>
  <h1>Belote ‚Äì Table
    <span id="partie-pill" class="pill"></span>
    <span id="manche-pill" class="pill"></span>
    <span id="atout-pill" class="pill"></span>
  </h1>

  <div class="row btns">
    <button id="btn-pass">üôÖ Pass</button>
    <button id="btn-take">üÉè Prendre (carte retourn√©e)</button>
    <button id="btn-choose">üé® Choisir couleur‚Ä¶</button>
  </div>

  <div id="table">
    <!-- 4 si√®ges -->
    <div id="seat-top" class="seat" style="left:310px; top:10px"></div>
    <div id="seat-right" class="seat" style="right:10px; top:200px"></div>
    <div id="seat-bottom" class="seat me" style="left:310px; bottom:10px"></div>
    <div id="seat-left" class="seat" style="left:10px; top:200px"></div>

    <!-- centre : carte retourn√©e + tapis pli courant -->
    <div id="center">
      <div id="returned"></div>
      <div id="trick"></div>
    </div>

    <div id="trick-grid">
      <div id="trick-n" class="trick-slot"></div>
      <div id="trick-e" class="trick-slot"></div>
      <div id="trick-s" class="trick-slot"></div>
      <div id="trick-w" class="trick-slot"></div>
    </div>
  </div>
  <!-- Dernier pli (hors tapis) -->
  <section id="last-trick-wrap" style="width:820px;margin:10px auto 0;">
    <h3 style="color:#fff;margin:0 0 6px;">Dernier pli</h3>
    <div id="last-trick" style="
    display:flex;gap:8px;align-items:center;justify-content:center;
    min-height:110px;opacity:.95;"></div>
  </section>

  <!-- Score live -->
  <section id="scoreboard" style="
  width:820px;margin:14px auto 0;display:flex;gap:12px;justify-content:center;">
    <div class="team" style="
    background:#ffffffee;padding:6px 10px;border-radius:10px;min-width:150px;text-align:center;">
      √âquipe 1 : <strong id="score1">0</strong>
    </div>
    <div class="team" style="
    background:#ffffffee;padding:6px 10px;border-radius:10px;min-width:150px;text-align:center;">
      √âquipe 2 : <strong id="score2">0</strong>
    </div>
  </section>
  <!-- Score cumul√© (toutes manches) -->
  <section id="scoreboard-total" style="
  width:820px;margin:10px auto 14px;display:flex;gap:12px;justify-content:center;">
    <div class="team" style="
    background:#ffffffee;padding:6px 10px;border-radius:10px;min-width:150px;text-align:center;">
      Total √âquipe 1 : <strong id="total1">0</strong>
    </div>
    <div class="team" style="
    background:#ffffffee;padding:6px 10px;border-radius:10px;min-width:150px;text-align:center;">
      Total √âquipe 2 : <strong id="total2">0</strong>
    </div>
  </section>
  <h3 style="color:#fff">Ma main</h3>
  <div id="my-hand"></div>

  <h2 style="color:#fff">Logs</h2>
  <pre id="log"></pre>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="./game.js"></script>

</body>

</html>